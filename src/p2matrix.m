% matrix elements from P2 integrals needed to construct FEM matrices
% see P2integrals.m for details on where these values come from

function [k0,k1,k2] = p2matrix(p,t)

% kinetic energy itegrals: del phi_i del phi_j
k0 = stiffnessP2(p,t);

% overlap integrals: int phi_i
k2 = [ 1,    -1/6, -1/6, 0,   -2/3,  0, ...
    -1/6,   1,   -1/6, 0,    0,   -2/3, ...
    -1/6,  -1/6,  1,  -2/3,  0,    0, ...
    0,     0,   -2/3, 16/3, 8/3,  8/3, ...
    -2/3,   0,    0,   8/3,  16/3, 8/3, ...
    0,    -2/3,  0,   8/3,  8/3,  16/3]/60;

% potential integrals: int phi_i phi_j phi_k
k1(1,:)=[ 1/70, -1/630, -1/630,  1/105,  1/315,  1/105,...
    -1/630, -1/630, 1/1260, -1/315,      0,      0,...
    -1/630, 1/1260, -1/630,      0,      0, -1/315,...
    1/105, -1/315,      0,      0, -2/315,      0,...
    1/315,      0,      0, -2/315, -4/315, -2/315,...
    1/105,      0, -1/315,      0, -2/315,      0];

k1(2,:)=[-1/630, -1/630, 1/1260, -1/315,      0,      0,...
    -1/630,   1/70, -1/630,  1/105,  1/105,  1/315,...
    1/1260, -1/630, -1/630,      0, -1/315,      0,...
    -1/315,  1/105,      0,      0,      0, -2/315,...
    0,  1/105, -1/315,      0,      0, -2/315,...
    0,  1/315,      0, -2/315, -2/315, -4/315];

k1(3,:)= [-1/630, 1/1260, -1/630,      0,      0, -1/315,...
    1/1260, -1/630, -1/630,      0, -1/315,      0,...
    -1/630, -1/630,   1/70,  1/315,  1/105,  1/105,...
    0,      0,  1/315, -4/315, -2/315, -2/315,...
    0, -1/315,  1/105, -2/315,      0,      0,...
    -1/315,      0,  1/105, -2/315,      0,      0];

k1(4,:)= [1/105, -1/315,      0,      0, -2/315,      0,...
    -1/315,  1/105,      0,      0,      0, -2/315,...
    0,      0,  1/315, -4/315, -2/315, -2/315,...
    0,      0, -4/315,   4/35,  4/105,  4/105,...
    -2/315,      0, -2/315,  4/105,  4/105,  8/315,...
    0, -2/315, -2/315,  4/105,  8/315,  4/105];

k1(5,:)= [1/315,      0,      0, -2/315, -4/315, -2/315,...
    0,  1/105, -1/315,      0,      0, -2/315,...
    0, -1/315,  1/105, -2/315,      0,      0,...
    -2/315,      0, -2/315,  4/105,  4/105,  8/315,...
    -4/315,      0,      0,  4/105,   4/35,  4/105,...
    -2/315, -2/315,      0,  8/315,  4/105,  4/105];

k1(6,:)=[1/105,      0, -1/315,      0, -2/315,      0,...
    0,  1/315,      0, -2/315, -2/315, -4/315,...
    -1/315,      0,  1/105, -2/315,      0,      0,...
    0, -2/315, -2/315,  4/105,  8/315,  4/105,...
    -2/315, -2/315,      0,  8/315,  4/105,  4/105,...
    0, -4/315,      0,  4/105,  4/105,   4/35];


